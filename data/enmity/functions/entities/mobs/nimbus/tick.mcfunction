tag @s add enmity.close_to_ground
execute if block ~0.15 ~ ~0.15 #enmity:nimbus_flight if block ~0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~0.15 ~-1 ~0.15 #enmity:nimbus_flight if block ~0.15 ~-1 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~-1 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~-1 ~-0.15 #enmity:nimbus_flight if block ~0.15 ~-2 ~0.15 #enmity:nimbus_flight if block ~0.15 ~-2 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~-2 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~-2 ~-0.15 #enmity:nimbus_flight if block ~0.15 ~-3 ~0.15 #enmity:nimbus_flight if block ~0.15 ~-3 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~-3 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~-3 ~-0.15 #enmity:nimbus_flight if block ~0.15 ~-4 ~0.15 #enmity:nimbus_flight if block ~0.15 ~-4 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~-4 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~-4 ~-0.15 #enmity:nimbus_flight if block ~0.15 ~-5 ~0.15 #enmity:nimbus_flight if block ~0.15 ~-5 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~-5 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~-5 ~-0.15 #enmity:nimbus_flight run tag @s remove enmity.close_to_ground
execute if entity @s[tag=enmity.close_to_ground] run effect give @s levitation 1 0 true
execute unless entity @s[tag=enmity.close_to_ground] if predicate enmity:random/random_0.5 run effect clear @s levitation
tag @s remove enmity.close_to_ground
particle cloud ~ ~0.4 ~ 0.4 0.2 0.4 0 1
execute if score %difficulty enmity.value matches 1 facing entity @p[gamemode=!creative,gamemode=!spectator,distance=7..20] eyes positioned ^ ^0.04 ^0.15 if block ~0.15 ~ ~0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~0.15 #enmity:nimbus_flight if block ~0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~0.15 ~0.975 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~0.975 ~0.15 #enmity:nimbus_flight if block ~0.15 ~0.975 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~0.975 ~-0.15 #enmity:nimbus_flight run tp @s ~ ~ ~ facing entity @p[gamemode=!creative,gamemode=!spectator]
execute if score %difficulty enmity.value matches 2 facing entity @p[gamemode=!creative,gamemode=!spectator,distance=7..20] eyes positioned ^ ^0.065 ^0.22 if block ~0.15 ~ ~0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~0.15 #enmity:nimbus_flight if block ~0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~0.15 ~0.975 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~0.975 ~0.15 #enmity:nimbus_flight if block ~0.15 ~0.975 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~0.975 ~-0.15 #enmity:nimbus_flight run tp @s ~ ~ ~ facing entity @p[gamemode=!creative,gamemode=!spectator]
execute facing entity @p[gamemode=!creative,gamemode=!spectator,distance=..7] eyes positioned ^ ^ ^-1 run summon marker ~ ~ ~ {Tags:["enmity.direction_anchor"]}
data modify entity @e[type=marker,tag=enmity.direction_anchor,limit=1] Pos[1] set from entity @s Pos[1]
execute facing entity @e[type=marker,tag=enmity.direction_anchor,limit=1] feet positioned ^ ^0.1 ^0.2 if block ~0.15 ~ ~0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~0.15 #enmity:nimbus_flight if block ~0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~ ~-0.15 #enmity:nimbus_flight if block ~0.15 ~0.975 ~0.15 #enmity:nimbus_flight if block ~-0.15 ~0.975 ~0.15 #enmity:nimbus_flight if block ~0.15 ~0.975 ~-0.15 #enmity:nimbus_flight if block ~-0.15 ~0.975 ~-0.15 #enmity:nimbus_flight run tp @s ~ ~ ~ facing entity @p[gamemode=!creative,gamemode=!spectator]
kill @e[type=marker,tag=enmity.direction_anchor]
execute if entity @s[nbt={HurtTime:9s}] run function enmity:entities/mobs/nimbus/on_harm